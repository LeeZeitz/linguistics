<!DOCTYPE html>
<html>
    <head>
        <title>My Experiment</title>
        <link rel="shortcut icon" href="https://blogonlinguistics.files.wordpress.com/2016/03/major_levels_of_linguistic_structure-ip3.png" />
        <script src="https://cdn.jsdelivr.net/gh/jspsych/jsPsych@6.1.0/jspsych.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jspsych/jsPsych@6.1.0/plugins/jspsych-audio-slider-response.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/jspsych/jsPsych@6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
        <link href="https://cdn.jsdelivr.net/gh/jspsych/jsPsych@6.1.0/css/jspsych.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1></h1>
        <button onclick="startExperiment()">Start Experiment</button>
    </body>
    <script>

        /**
        * Randomly shuffle an array
        * https://stackoverflow.com/a/2450976/1293256
        */
        function shuffle(array) {

            var currentIndex = array.length;
            var temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {
                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }

            return array;
        };

        function startExperiment() {
            var mediaUrl = 'https://raw.githubusercontent.com/LeeZeitz/linguistics/master/media/audio/';
            var min = -3;
            var max = 3;

            var welcome = {

            };
            var consent = {
                type: 'html-keyboard-response',
                stimulus: 
                    `
                    <h3>Consent Form</h3>
                    <p>Press any key to consent</p>
                    `
            };
            var instructions = {
                type: 'html-keyboard-response',
                stimulus: 
                    `
                    
                    `
            }

            // Define the different trials and their variables
            
            /**
            * TODO: @Kate
              These are the variables you want to edit to get your sound clips to play.
              Each of these objects has an 'audio' property. Change these properties to the names of their corresponding audio files.
              Be sure to put the audio files in the /media/audio directory of the repo. That's where it's going to look for them.
              Also be sure to include the file's extention in the name (as you can see with 'gameover.mp3')
              **NOTE: I noticed your files are .wav files so I tested this with some random .wav files and was having trouble getting it to recognize them as audio.
              **      Might be easiest/safest to convert your .wav files to .mp3

            */
            var trialVars = {
                1: {
                    'prompt': 'How friendly is the speaker?',
                    'min': 'unfriendly',
                    'max': 'friendly',
                    'audio': 'LowMCrk1.mp3'
                },
                2: {
                    'prompt': 'How sympathetic is the speaker?',
                    'min': 'unsympathetic',
                    'max': 'sympathetic',
                    'audio': 'LowMCrk1.mp3'
                },
                3: {
                    'prompt': 'How likeable is the speaker?',
                    'min': 'unlikeable',
                    'max': 'likeable',
                    'audio': 'LowMCrk1.mp3'
                },
                4: {
                    'prompt': 'How trustworthy is the speaker?',
                    'min': 'untrustworthy',
                    'max': 'trustworthy',
                    'audio': 'LowMCrk1.mp3'
                },
                5: {
                    'prompt': 'How ambitious is the speaker?',
                    'min': 'unambitious',
                    'max': 'ambitious',
                    'audio': 'LowMCrk1.mp3'
                },
                6: {
                    'prompt': 'How intelligent is the speaker?',
                    'min': 'unintelligent',
                    'max': 'intelligent',
                    'audio': 'LowMCrk1.mp3'
                },
                7: {
                    'prompt': 'How educated is the speaker?',
                    'min': 'uneducated',
                    'max': 'educated',
                    'audio': 'LowMCrk1.mp3'
                },
                8: {
                    'prompt': 'How authoritative is the speaker?',
                    'min': 'unauthoritative',
                    'max': 'authoritative',
                    'audio': 'LowMCrk1.mp3'
                },
            }

            // Generate a random order for the trials
            var order = [];
            for (var i = 1; i < Object.keys(trialVars).length + 1; i++) {
                order.push(i);
            };
            random_order = shuffle(order);

            // Add the trials in their random order to the jsPsych timeline
            var timeline = [instructions];
            random_order.forEach((trialNum) => {
                var trial = trialVars[trialNum];
                timeline.push({
                    type: 'audio-slider-response',
                    stimulus: mediaUrl.concat(trial.audio),
                    labels: [trial.min, trial.max],
                    prompt: trial.prompt
                });
            });
             
            // Initialize jsPsych
            jsPsych.init({
                timeline: timeline
            })
        }

    </script>
</html>
